{% extends 'base.html' %}

{% block conteudo %}

<!-- Importar SweetAlert2 -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<!-- Importando a biblioteca InputMask para fazer uma mascara de input -->
<!-- Carrega a biblioteca jQuery (necessÃ¡rio para o inputmask funcionar) -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- Carrega a biblioteca Inputmask -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.inputmask/5.0.8/jquery.inputmask.min.js"></script>

<div class="container mt-5">
    <div class="text-center mb-4">
        <h2 class="text-primary fw-bold">ğŸ“ Registro de um novo crismando</h2>
    </div>

    <div class="card shadow-sm p-4">
        <form action="{{ url_for('crismando_bp.salvar_crismando') }}" method="POST" id="formCadCrismando">
            <div class="row g-3">
                <!-- Nome -->
                <div class="col-md-6">
                    <label class="form-label fw-bold">ğŸ‘¤ Nome Completo:</label>
                    <input type="text" name="nome" class="form-control" required>
                </div>
                
                <!-- Data de nascimento -->
                <div class="col-md-6">
                    <label class="form-label fw-bold">ğŸ‚ Data de Nascimento:</label>
                    <input type="date" name="data_nascimento" class="form-control" required>
                </div>

                <!-- Telefone 1 -->
                <div class="col-md-6">
                    <label class="form-label fw-bold">ğŸ“ Contato 1:</label>
                    <input type="text" id="contato1" name="tel1" maxlegth="15" class="form-control rounded-3" required>
                </div>

                <!-- Telefone 2 -->
                <div class="col-md-6">
                    <label class="form-label fw-bold">ğŸ“ Contato 2:</label>
                    <input type="text" id="contato2" name="tel2" maxlegth="15" class="form-control rounded-3">
                </div>

                <!-- Nome da mÃ£e -->
                <div class="col-md-6">
                    <label class="form-label fw-bold">ğŸ‘© Nome da MÃ£e:</label>
                    <input type="text" name="nome_mae" class="form-control rounded-3">
                </div>

                <!-- Nome do pai -->
                <div class="col-md-6">
                    <label class="form-label fw-bold">ğŸ‘¨ Nome do Pai:</label>
                    <input type="text" name="nome_pai" class="form-control">
                </div>

                <!-- EndereÃ§o -->
                <div class="col-md-6">
                    <label class="form-label fw-bold">ğŸ  EndereÃ§o:</label>
                    <input type="text" name="endereco" class="form-control" placeholder="Rua, NÂº, Bairro">
                </div>

                <!-- Cidade -->
                <div class="col-md-6">
                    <label class="form-label fw-bold">ğŸŒ† Cidade:</label>
                    <input type="text" name="cidade" class="form-control" placeholder="Cidade - UF">
                </div>

                <!-- Grupo -->
                <div class="col-md-6">
                    <label class="form-label fw-bold">ğŸ“Œ Turma:</label>
                    <select name="fk_id_grupo" class="form-select" required>
                        <option value="">Selecione a turma</option>
                        {% for grupo in grupos_disponiveis %}
                            {% if grupo.id_grupo != 27 %}
                                <option value="{{ grupo.id_grupo }}">{{ grupo.nome_grupo }}</option>
                            {% endif %}
                        {% endfor %}
                    </select>
                </div>

                <!-- Batismo -->
                <div class="col-md-6">
                    <label class="form-label fw-bold">â›ª Ã‰ Batizado?</label>
                    <select name="batismo" class="form-select" >
                        <option value="sim">Sim</option>
                        <option value="nao" selected>NÃ£o</option>
                    </select>
                </div>

                <!-- Eucaristia -->
                <div class="col-md-6">
                    <label class="form-label fw-bold">ğŸ•Šï¸ Fez a 1Âº ComunhÃ£o?</label>
                    <select name="eucaristia" class="form-select">
                        <option value="sim">Sim</option>
                        <option value="nao" selected>NÃ£o</option>
                    </select>
                </div>

                <!-- Estado civil -->
                <div class="col-md-6">
                    <label class="form-label fw-bold">ğŸ’ Estado Civil:</label>
                    <select name="estado_civil" class="form-select">
                        <option value="solteiro"selected >Solteiro(a)</option>
                        <option value="namorado" >Solteiro(a), mas tenho namorado(a)/Noivo(a)</option>
                        <option value="casado_civil" >Casado(a) civilmente (mas nÃ£o sou casado(a) na Igreja).</option>
                        <option value="casado_civil_igreja" >Casado(a) no Civil e na Igreja (Matrimonio).</option>
                        <option value="mora_junto" >Moro junto (nÃ£o sou casado(a) na Igreja e tambÃ©m nÃ£o sou no Civil).</option>
                    </select>
                </div>

                <!-- Possui filhos -->
                <div class="col-md-6">
                    <label class="form-label fw-bold">ğŸ‘¶ Possui filhos?</label>
                    <select name="possui_filhos" class="form-select">
                        <option value="nao" selected >NÃ£o</option>
                        <option value="sim" >Sim</option>
                    </select>
                </div>

                <!-- Possui deficiÃªncia -->
                <div class="col-md-6">
                    <label class="form-label fw-bold">â™¿ Possui deficiÃªncia?</label>
                    <select name="possui_deficiencia" id="possui_deficiencia" class="form-select" required>
                        <option value="nao" selected>NÃ£o</option>
                        <option value="sim">Sim</option>
                    </select>
                </div>

                <div class="col-md-6 d-none" id="campo_deficiencia_descricao">
                    <label class="form-label fw-bold">ğŸ’¬ Descreva a deficiÃªncia:</label>
                    <input type="text" name="descricao_deficiencia" id="descricao_deficiencia" class="form-control">
                </div>
            </div>

            <div class="text-center mt-4">
                <button type="submit" class="btn btn-success">ğŸ’¾ Salvar</button>
                <a href="{{ url_for('crismando_bp.lista_de_crismandos') }}" class="btn btn-secondary ms-2">â¬…ï¸ Voltar</a>
            </div>


            
        </form>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        const selectDeficiencia = document.getElementById("possui_deficiencia");
        const campoDescricao = document.getElementById("campo_deficiencia_descricao");

        selectDeficiencia.addEventListener("change", function() {
            if (this.value === "sim") {
                campoDescricao.classList.remove("d-none");
            } else {
                campoDescricao.classList.add("d-none");
                document.getElementById("descricao_deficiencia").value = ""; // limpa
            }
        });
    });

    // SweetAlert para confirmaÃ§Ã£o
    document.getElementById("formCadCrismando").addEventListener("submit", function (event) {
        event.preventDefault();

        Swal.fire({
            title: "Tem certeza?",
            text: "VocÃª deseja salvar essas informaÃ§Ãµes?",
            icon: "warning",
            showCancelButton: true,
            confirmButtonText: "Sim, salvar!",
            cancelButtonText: "Cancelar"
        }).then((result) => {
            if (result.isConfirmed) {
                this.submit();
            }
        });
    });


    // JS para aplicar a mascara
    $(document).ready(function() {
        $("#contato1").inputmask("(99)9.9999-9999"); // MÃ¡scara para nÃºmero de contato 1
        $("#contato2").inputmask("(99)9.9999-9999"); // MÃ¡scara para nÃºmero de contato 2
    });

</script>

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
      {% for category, message in messages %}
        Swal.fire({
          icon: '{{ 'error' if category == 'danger' else 'success' }}',
          title: '{{ message }}',
          confirmButtonText: 'OK'
        }).then(() => {
          window.location.href = "{{ url_for('crismando_bp.lista_de_crismandos') }}";
        });
      {% endfor %}
    </script>
  {% endif %}
{% endwith %}

{% endblock %}
